原论文题名：《Quantifying small molecule phenotypic effects using mitochondrial morpho-functional fingerprinting and machine learning》。地址[在这里](https://www.nature.com/articles/srep08035)。

最近因为准备到生科那边做一点工作，所以先帮生物科学的老师那边做点事。
生科学院的文铁桥教授准备组一个大学生创新项目（我本人不参加），然后想做细胞器的相关内容，我主要是负责其中机器学习的内容，所以文老师给了一篇Nature上用机器学习做线粒体的文章（荷兰的内梅亨大学的人做的），拿来读读看。
读完觉得有点意思，实验设计把机器学习挺好的融入进去了，这里简单说一下他们的思路。

#总体思路
在Leigh Syndrome这种病症的病人的成纤维细胞中有线粒体异常和活性氧簇（ROS）的异常问题。一些前置的研究证明了针对这些ROS的一些小分子可能是有效的，但是又有一些微妙的效果（subtle effect），而且在病人身上证明效果不是太好，效果也短暂。
作者提出了一种基于机器学习的，验证新药的方法，然后用名为Trolox的一种抗氧化剂以及几个变种做了证实性实验。
这个验证模型基本上有三步：1.黄色)自动化的线粒体特征（fingerprint）提取；2.蓝色)训练一个监督学习的机器学习模型；3.绿色)用这个模型来判定小分子药物的效果。

![](./_image/2018-04-18-11-05-30.jpg)

#特征工程
其中第一步就是我们说的特征工程了，作者给了31个特征放在附录里，主要是提取细胞内线粒体的一些形态，包括面积、周长、相关东西的比率、均值等等……用的都是比较传统的找法。图一共一千多张，但是线粒体的对象（object）快三十万个，不知道是不是手工找的，那还真是蛮有毅力。
这里插一句，作者提到，一张图有很多线粒体对象，团队就直接取各个线粒体的中位数作为整个图片的特征，说是为了防止outliers影响分析，不过这不是浪费了好多样本吗……理应有更好的方法才对。
#监督学习
有了数据集直接就用了五个常用的监督机器学习去分类，最后做出来效果SVM和逻辑回归效果最好，所以后续就用了逻辑回归。另一个原因讲逻辑回归比SVM解释性更好（easy to interpret）。其实我个人觉得可能后一个原因占比大一些，SVM用了核方法之后基本也不怎么好解释，而且一般SVM效果都好，如果不是逻辑回归能算出个敏感度向量，不选SVM没道理。
这还是让人比较担心的，不知道生物上是不是非常看重这个可解释性，后面做项目如果想用DL解释性基本没有，可能会有影响。
最后逻辑回归在测试集上做到78%的分类正确率，其实还是比较差劲的。
#实证实验
实证实验也比较简单，就是把几种药物的变种施加到P5175细胞（有病的细胞），看逻辑回归给出的评分降没降。因为实验中是以0.5为阈值，低于这个的判定为CT5120细胞（正常细胞），最后实验做出来发现只有KH0003这个药能使分类器认为这个细胞变正常了。
下图中给了实验结果，31个特征的颜色深度表示各个特征的程度，可以看到只有KH003作用后关键指标才降下去，使分类器认为这个细胞正常。
![](./_image/2018-04-18-11-07-59.jpg)
但是实际上作者给的实证数据也不多，各个药物的验证数目也就在50到100之间，所以基本上属于小样本分析。
#总结
总的来说这个实验设计得还是很漂亮，就是为了解决人类其实不知道药物的作用效果怎么样的问题，用一个所谓的“AI”来学习怎么通过多个特征来判定一个细胞是不是病人的细胞，把这个AI训练完了之后就当它是一个天才医生，然后通过它来看用药之后的细胞确定这个药物好不好。
实际上这个操作也就是统计学上的一些操作，各种机器学习和统计学的问题都会影响到它，一个比较明显的就是特征可能取得不够好，说到底他们这些特征取得也比较奇奇怪怪（虽然也可能是因为我不懂生物学知识……），应该还有一些改进空间。
另外就是可以考虑用Deep Learning，加大数据量，直接走一个DenseNet，或者是做一个VGG-19的Transfer Learning可能也会效果比较好。